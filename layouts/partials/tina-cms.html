{{ if or (eq (getenv "HUGO_TINA_DEV") "true") (getenv "TINA_CLIENT_ID") }}
<!-- Tina CMS Script -->
<script>
  // Check if we're in the TinaCMS iframe context
  const isFramed = window.self !== window.top;
  
  if (isFramed) {
    // Load TinaCMS in iframe context
    fetch('/___tina/tinacms.js')
      .then(response => response.text())
      .then(script => {
        eval(script);
      })
      .catch(err => {
        console.warn('TinaCMS client not loaded:', err);
      });
  } else {
    // Only redirect to admin if specifically accessing admin pages
    // For direct access to pages, do not redirect automatically
    // This allows users to view the site normally without being redirected
  }
  </script>
{{ end }}